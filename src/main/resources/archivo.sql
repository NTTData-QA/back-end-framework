-- H2 2.3.232;
SET DB_CLOSE_DELAY -1;
;
CREATE USER IF NOT EXISTS "SA" SALT 'cbde515f6a8e18ca' HASH 'a2192fb069e1591920f29c6ed7c27a2142c0c177ab7faa8a6efdd1b847ffa6fe' ADMIN;

DROP TABLE IF EXISTS "PUBLIC"."Account" CASCADE;
DROP TABLE IF EXISTS "PUBLIC"."Card" CASCADE;
DROP TABLE IF EXISTS "PUBLIC"."Customer" CASCADE;
DROP TABLE IF EXISTS "PUBLIC"."Transfer" CASCADE;
DROP TABLE IF EXISTS "PUBLIC"."Withdraw" CASCADE;

CREATE CACHED TABLE "PUBLIC"."Account"(
    "accountId" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 193) NOT NULL,
    "amount" FLOAT(53),
    "customerId" INTEGER NOT NULL,
    "isBlocked" BOOLEAN,
    "isInDebt" BOOLEAN,
    "creationDate" TIMESTAMP(6),
    "expirationDate" TIMESTAMP(6),
    "accountType" CHARACTER VARYING(255)
);
ALTER TABLE "PUBLIC"."Account" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_1" PRIMARY KEY("accountId");
-- 7 +/- SELECT COUNT(*) FROM PUBLIC.Account;
INSERT INTO "PUBLIC"."Account" VALUES
(1, 4890.0, 1, FALSE, FALSE, TIMESTAMP '2023-01-01 00:00:00', TIMESTAMP '2026-01-01 00:00:00', 'CHILDREN_ACCOUNT'),
(2, 10.0, 2, FALSE, FALSE, TIMESTAMP '2022-05-10 00:00:00', TIMESTAMP '2025-05-10 00:00:00', 'SAVINGS_ACCOUNT'),
(33, 800.0, 161, FALSE, FALSE, TIMESTAMP '2024-10-21 12:35:36.265007', TIMESTAMP '2025-10-21 12:35:36.265007', 'BUSINESS_ACCOUNT'),
(65, 800.0, 161, FALSE, FALSE, TIMESTAMP '2024-10-21 12:38:53.378858', TIMESTAMP '2025-10-21 12:38:53.378858', 'BUSINESS_ACCOUNT'),
(97, 800.0, 161, FALSE, FALSE, TIMESTAMP '2024-10-21 12:39:11.212618', TIMESTAMP '2025-10-21 12:39:11.212618', 'BUSINESS_ACCOUNT'),
(129, 800.0, 161, FALSE, FALSE, TIMESTAMP '2024-10-21 12:50:43.206184', TIMESTAMP '2025-10-21 12:50:43.206184', 'BUSINESS_ACCOUNT'),
(161, 800.0, 161, FALSE, FALSE, TIMESTAMP '2024-10-21 12:52:35.187724', TIMESTAMP '2025-10-21 12:52:35.187724', 'BUSINESS_ACCOUNT');
CREATE CACHED TABLE "PUBLIC"."Card"(
    "account_id"    INTEGER NOT NULL,
    "cardId"        INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "type"          CHARACTER VARYING(255),
    "number"        BIGINT,
    "cvc"           INTEGER NOT NULL,
    "expirationDate" TIMESTAMP(6),
    "isBlocked"     BOOLEAN,
    "dailyLimit"    DOUBLE,
    "monthlyLimit"  DOUBLE
);
ALTER TABLE "PUBLIC"."Card" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_1F" PRIMARY KEY("cardId");
-- 2 +/- SELECT COUNT(*) FROM PUBLIC.Card;
INSERT INTO "PUBLIC"."Card"
("account_id","type","number","cvc","expirationDate","isBlocked","dailyLimit","monthlyLimit")
VALUES
(1, 'Credit', 1234567890123456, 123, TIMESTAMP '2025-12-31 00:00:00', FALSE, 300.0, 1500.0),
(2, 'Debit',  9876543210123456, 456, TIMESTAMP '2026-10-20 00:00:00', FALSE, 200.0, 1000.0);
CREATE CACHED TABLE "PUBLIC"."Customer"(
    "customerId" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1 RESTART WITH 641) NOT NULL,
    "email" CHARACTER VARYING(255) NOT NULL,
    "name" CHARACTER VARYING(255) NOT NULL,
    "password" CHARACTER VARYING(255) NOT NULL,
    "surname" CHARACTER VARYING(255) NOT NULL
);
ALTER TABLE "PUBLIC"."Customer" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_27" PRIMARY KEY("customerId");
-- 14 +/- SELECT COUNT(*) FROM PUBLIC.Customer;
INSERT INTO "PUBLIC"."Customer" VALUES
(1, 'john.doe@example.com', 'John', 'password123', 'Doe'),
(2, 'jane.smith@example.com', 'Jane', 'securepass', 'Smith'),
(33, 'julia@sanz.com', 'Julia', 'hola', 'Sanz'),
(65, 'franro@email.es', 'Fran', '1234', 'Rodriguez'),
(66, 'jorgejimo@email.es', 'Jorge', '2432762', 'Jimenez'),
(97, 'customer@example.com', 'Jane', 'password123', 'Doe'),
(129, 'pepeG@email.es', 'pepito', '4466', 'grillo'),
(161, 'csan@email.com', 'carlos', '2334', 'sanchez'),
(193, 'new.user@example.com', 'New', 'newpassword', 'User'),
(353, 'testuser@example.com', 'John', 'password123', 'Doe'),
(385, 'probandoo@example.com', 'John', 'password123', 'Doe'),
(417, 'probando2@example.com', 'John', 'password123', 'Doe'),
(449, 'probando3@example.com', 'John', 'password123', 'Doe'),
(513, 'alice.johnson@example.com', 'Alice2', 'newpassword123', 'Johnson');
CREATE CACHED TABLE "PUBLIC"."Transfer"(
    "originAccountId" INTEGER NOT NULL,
    "receivingAccountId" INTEGER NOT NULL,
    "transferAmount" FLOAT(53) NOT NULL,
    "transferId" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
    "transferDate" TIMESTAMP(6) NOT NULL,
    "currencyType" ENUM('EUR', 'USD') NOT NULL,
    "transferStatus" ENUM('FAILED', 'PENDING', 'SUCCESSFUL') NOT NULL
);
ALTER TABLE "PUBLIC"."Transfer" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_5" PRIMARY KEY("transferId");
-- 9 +/- SELECT COUNT(*) FROM PUBLIC.Transfer;
INSERT INTO "PUBLIC"."Transfer"
("originAccountId","receivingAccountId","transferAmount","transferDate","currencyType","transferStatus") VALUES
(1, 2, 100.0,      TIMESTAMP '2024-10-15 12:48:58.235628', 'USD', 'PENDING'),
(1, 2, 100.0,      TIMESTAMP '2024-10-15 00:00:00',       'EUR', 'SUCCESSFUL'),
(1, 2, -1.0,       TIMESTAMP '2024-10-15 00:00:00',       'EUR', 'FAILED'),
(1, 2, 5000000.0,  TIMESTAMP '2024-10-15 00:00:00',       'EUR', 'FAILED'),
(2, 1, 30.0,       TIMESTAMP '2024-10-15 00:00:00',       'EUR', 'FAILED'),
(1, 2, 5.0E8,      TIMESTAMP '2024-10-15 00:00:00',       'EUR', 'FAILED'),
(1, 2, -2.0,       TIMESTAMP '2024-10-15 00:00:00',       'EUR', 'FAILED'),
(2, 1, 10.0,       TIMESTAMP '2024-10-15 00:00:00',       'EUR', 'FAILED'),
(1, 2, 10.0,       TIMESTAMP '2024-10-15 00:00:00',       'EUR', 'SUCCESSFUL');
 CREATE CACHED TABLE "PUBLIC"."Withdraw"(
     "withdrawId" INTEGER GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,
     "amount" FLOAT(53) NOT NULL,
     "withdrawDate" TIMESTAMP(6) NOT NULL,
     "cardId" INTEGER NOT NULL
 );
ALTER TABLE "PUBLIC"."Withdraw" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_WD_PK" PRIMARY KEY ("withdrawId");
INSERT INTO "PUBLIC"."Withdraw" ("amount","withdrawDate","cardId") VALUES
  ( 40.00, TIMESTAMP '2024-10-15 08:15:00', 1),
  ( 20.00, TIMESTAMP '2024-10-15 12:30:00', 1),
  ( 60.00, TIMESTAMP '2024-10-16 09:10:00', 1),
  ( 15.50, TIMESTAMP '2024-10-20 18:45:00', 1),
  (100.00, TIMESTAMP '2024-10-15 10:00:00', 2),
  ( 25.00, TIMESTAMP '2024-10-16 11:20:00', 2),
  ( 70.00, TIMESTAMP '2024-10-18 14:05:00', 2),
  ( 10.00, TIMESTAMP '2024-10-20 19:30:00', 2);
ALTER TABLE "PUBLIC"."Customer" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_2" UNIQUE NULLS DISTINCT ("email");
ALTER TABLE "PUBLIC"."Customer" ADD CONSTRAINT "PUBLIC"."UK3qgg01qojcmbdp47dkaom9x45" UNIQUE NULLS DISTINCT ("email");
ALTER TABLE "PUBLIC"."Card" ADD CONSTRAINT "PUBLIC"."FKlysvqk4w1kwtyly1bh7iei4nl" FOREIGN KEY("account_id") REFERENCES "PUBLIC"."Account"("accountId") NOCHECK;
ALTER TABLE "PUBLIC"."Transfer" ADD CONSTRAINT "PUBLIC"."FKc9okp77s80u7rbm6xqae8k5n7" FOREIGN KEY("receivingAccountId") REFERENCES "PUBLIC"."Account"("accountId") NOCHECK;
ALTER TABLE "PUBLIC"."Transfer" ADD CONSTRAINT "PUBLIC"."FKfbfjrn8mktkla89423xurqr9x" FOREIGN KEY("originAccountId") REFERENCES "PUBLIC"."Account"("accountId") NOCHECK;
ALTER TABLE "PUBLIC"."Account" ADD CONSTRAINT "PUBLIC"."FKdv4pd5yxpjc7j7mrrprwatiyc" FOREIGN KEY("customerId") REFERENCES "PUBLIC"."Customer"("customerId") NOCHECK;
ALTER TABLE "PUBLIC"."Withdraw" ADD CONSTRAINT "PUBLIC"."FK_withdraw_card" FOREIGN KEY ("cardId") REFERENCES "PUBLIC"."Card"("cardId") NOCHECK;